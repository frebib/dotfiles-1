#!/bin/sh

bspc config border_width              2
bspc config top_padding               $PANEL_HEIGHT
bspc config split_ratio               0.50
bspc config single_monocle            true
bspc config gapless_monocle           true
bspc config borderless_monocle        true
bspc config focus_by_distance         true
bspc config remove_disabled_monitors  true
bspc config remove_unplugged_monitors true
bspc config normal_border_color       '#333333'
bspc config focused_border_color      '#F9D3A5'
bspc config initial_polarity          second_child
bspc config window_gap                0

# Setup workspaces
bspc monitor "$MAIN_DISPLAY" -d one two three four five six seven eight

# Check if the second monitor is connected
if xrandr | grep connected | grep $SECOND_DISPLAY; then
  echo Setting up second display
  bspc monitor "$SECOND_DISPLAY" -d uno dos
  # Check if the monitors are in the wrong order
  if ! bspc query --monitors --names | head -1 | grep $MAIN_DISPLAY; then
    bspc monitor "$MAIN_DISPLAY" --swap "$SECOND_DISPLAY"
  fi
else
  bspc monitor "$SECOND_DISPLAY" -d None
fi

# Rule for quake-like terminal
bspc rule --add *:QuakeTerminal state=floating sticky=on border=on

# Set background
feh --bg-fill $BACKGROUND_IMAGE
# Start bar
killall panel.py ; python3 $PANEL_PATH/panel.py &
# Start compton
killall compton ; compton &
# Start sxhkd
killall sxhkd ; sxhkd &
